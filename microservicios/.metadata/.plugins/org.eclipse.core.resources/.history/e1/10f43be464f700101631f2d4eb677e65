package com.osiel.medicos.mappers;

import java.net.Authenticator.RequestorType;
import java.util.Arrays;

import org.springframework.stereotype.Component;

import com.example.demo.dto.MedicoRequest;
import com.example.demo.dto.MedicoResponse;
import com.example.demo.enums.EstadoRegistro;
import com.example.demo.mappers.CommonMapper;
import com.osiel.medicos.entities.Medico;
import com.osiel.medicos.enums.DisponibilidadMedico;
import com.osiel.medicos.enums.EspecialidadMedico;

@Component
public class MedicoMapper implements CommonMapper<MedicoRequest, MedicoResponse, Medico>{

	@Override
	public MedicoResponse entityToResponse(Medico entity) {
		if(entity == null) return null;
		String nombre = String.join(" ", entity.getNombre(), entity.getApellidoPaterno(), entity.getApellidoMaterno());
		return new MedicoResponse(
				entity.getId(),
				nombre,
				entity.getEdad(),
				entity.getEmail(),
				entity.getTelefono(),
				entity.getCedulaProfesional(),
				entity.getEspecialidad().getDescripcion(),
				entity.getDisponibilidad().getDescripcion()
				);
	}

	@Override
	public Medico requestToEntity(MedicoRequest request) {
		if(request == null) return null;
		Medico medico = new Medico();
		
		EspecialidadMedico especialidad = EspecialidadMedico.fromCodigo(request.idDisponibilidad());
		
		medico.setNombre(request.nombre());
		medico.setApellidoPaterno(request.apellidoPaterno());
		medico.setApellidoMaterno(request.apellidoMaterno());
		medico.setEdad(request.edad());
		medico.setEmail(request.email());
		medico.setTelefono(request.telefono());
		medico.setCedulaProfesional(request.cedulaProfesional());
		medico.setDisponibilidad(DisponibilidadMedico.DISPONIBLE);
		medico.setEstadoRegistro(EstadoRegistro.ACTIVO);
		medico.setDisponibilidad(RequestorType.);
		
		return medico;
	}
	
	public Medico requestToEntity(MedicoRequest request, EspecialidadMedico especialidadMedico) {
		if(request == null) return null;
		Medico medico = requestToEntity(request);
		
		medico.setEspecialidad(especialidadMedico);
		
		return medico;
	}


	@Override
	public Medico updateEntityFromRequest(MedicoRequest request, Medico entity) {
		
		
		entity.setNombre(request.nombre());
		entity.setApellidoPaterno(request.apellidoPaterno());
		entity.setApellidoMaterno(request.apellidoMaterno());
		entity.setEdad(request.edad());
		entity.setEmail(request.email());
		entity.setTelefono(request.telefono());
		entity.setCedulaProfesional(request.cedulaProfesional());
		
		return entity;
	}
	
	public Medico updateEntityFromRequest(MedicoRequest request, Medico entity, DisponibilidadMedico disponibilidadMedico, EspecialidadMedico especialidadMedico) {
		
		entity = updateEntityFromRequest(request, entity);
		
		entity.setDisponibilidad(disponibilidadMedico);
		
		entity.setEspecialidad(especialidadMedico);
		
		return entity;
	}

}
